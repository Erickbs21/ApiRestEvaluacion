## üîó Link de el diagrama de base de datos:
 [üìñ Descripci√≥n](https://mermaid.live/edit#pako:eNrtWktz2zgS_isoVqUqqdEkEyfOwzdFkhPtWLZWkrNVW65iQSSsIEMSHJB0Jc7kj-xtjjnklFuu-mPbjQefIK1cducwOcRkAw02Gt1fP6BPXiBC5p14TE453UkaXyUE_t27R2ZJzkMasoykkicBT2nEMj06OZvPzjcz8km_4j-e5CSIOEty5vOQLH8lV94kojcMuWMqOb3yqtlZDkvuSJhycokzpyIoYuAVZMlkJhIakZCReQgkfs0DGvD9t8SxQCLirQQJr7xz8xSyyMrhmE9TFkU8FMgxLp-HeVhMeaTFnAgpmSAsYkEuQSIeCLL_jn8cfDlMuxaJQOH232MmBe4JqPsvSK5zhDRn5JoF76ifwF5jrlRx5Z0iCbkqqkuLXLIg4CJBRepnkI0EIk4jljf0zpIiJjuWoDBX3mJETkfkIpeiM4dlOQ2FH_Ab2PuVtxZRDjwjMqEZ0Edkym-EDLh6fsuL0CVXKsU1y7RcS_2MchUEDjvtHmnIYI9w8MAKBykyHwwiK9DogH9uiKQiwvyISpAg60if8xRk1yeqmEPYRwhsIzKLU1gI7RFe3s6XPTtH-why2OSIzEH5-mldZCmDtXDTryLxe8Fo2DnHnMf2LCXbcdBF4yRLGkvAjkgGL2BgzkWKCP5QX30dPRGW2f9H0UhF67FddMesCAqZ0aiUAx3zFO14bUZIKBKQKSvF2n9znGMgcZ9-KiSwXoL2JRcENo8D-2-4C_uBAV3gIsZGS11oGtpE2LOIkSAWoYIBpxRm8GBJ7GJtafbftW6r8ZqBfr5K9MP6cnK5Wo_P2thXKvtg8APg5TvhW0aDMPtvSDWogmLZ8V70K8EPZ0d0iOEHkKILYhuLXHd_R0PmlTdTf_GkRZKDzTrRi6VU5jQ2kDetvT6aKV90GUQB6uEpVyhmnx9NAIho6Jh-CxEFLAdWi2o61gQXBEU053kRKsQXEqIQDanetaI7WUSyc_OYATdIlaePEGmiLAANC4okRLsZkTHAdYAPE_qeNQ1bGfU7IdEVfAhtMi8khZXeAAk_bUm9PAFnUhmQ5dCEOzCRlpgITwsKyJM4glPL62rilR5X0voNCl1rx6RNKxR6zdBaUR4zcLc9_p8QrASN2WJ5NhtPL9qgwcxOfhg0LGMfaNjx_13ONfDF_qRrgOmOrCsQEk6TYlz-C6ZefXs7JP2yyVMBToezJlTC0QpLwH1IuqXvuwu3kPQt_KUZfAC8TBkug5e1zjfgabV682ZEXqMLBU1Ts5AGvqQcBfIF82SSrx79mcStrjxLouigTKdePdzwNUho6syGcj_jYEIRWOSDH0nW3tKg3PUZDwyIThmkcJjB9SZLnRyJZnyHYN7lAMXe8EzILjJVY46jLTQA-Sb3q0ESnB_mdoFSmTM5VLtO-A2LfDPvynsFEgZq75Cjx7A7eB7f0ORWZefjMOYJwhK8yb-zu-HsbnIJde24U9cW6EqHgzScEXi4r9k0hlkYqiBaj7aNqlZCn-pv6SIGaqmUQ4oGaumpdvTHwBMguKtKDf4o3hFZRvRW-Kf8PZIlGIgTyzSuVwuVSWUWSJ6iU5lA25W8hhhwiOCBhcpo1vhKzOthvCHPUpHwbcRK_hpJ-QdYcpLRQPu2MxUDvAYVBnqnsM7Z_itStFHuvyhqD6q01gi5QcDaEo3vEzWDZk6zTpgCtNebf47I5XoKxefl6kdyK1tjYvIHeVkLg2rYeUBy5VB8xV_mgZXzakqPlhqAaT80UF3SreTN0rKR_XRWKHEUEUAzDxsPBDqMP4B_KjHZwKsOP0DZf8nMHsCE2jLA8WX-DuMjKm-6_0oxMyGGouwtE1vEHdnsM2yFABETgKTfC9AV82mRC8lvLfCseTlEqiFEw2EjtuGfJ5UnLufnYCvKC1EpQwdaNQ4EQOFNN5-JDBJCMC-H_44Kw1FhOX7dSd1TuhM_HBFqp94XFsopreS7FofAliCHrEKENhPg1QM9XIDjOU-Eg82MDCZaKsbgnnWJLjLAUMghQccYazYo9LVJJSHeoG7WmADBTjPzvpSIdHE3fGXFtr76DE5MZ3CTd-BArLW6P55A2rqh8j1zQwHArjL4hfqrfaVPqZYnEDE3jcqJekT71KoInR_hcZmfz-2jmS96hfJzoRsQWjT9dl_L-5ORAT_8U7n8A2cFmAQsNb0SFZord0IVOlgkK7XHPgAiJggqq5JILLHHAFpZjTqVZmVlaAfxt3CytkoDJvvj5BJbsCaxkQJyYJqEKt_RTSx8PqWqyMSeCSgrUrQVu4EowwcbtnX_tCjxUXVL7jKk5jqplqtbTDYGBha4oZHCPM2o31TcMDGuGTOG65dajxcKqtuBOOwMv1rkLleg2lHIAz4w1X1oRVLnGO__zBHRhk2CpwbMcI0lAhHCkZUXh3jibknTRGeYZpNQ5mwWpgJKWD4iC7HlEUMDiCJ_gtYinSkvJA4-DRGnEnPTcI40UqMNJLq4LIf6r9yEyXgN3UCvA5eb62Aj0rlQOXDoSqVEFtP7RDLjh8jUXqojlGOtv0jf7dV8M55crDoF3ZbnNBDykJKuin6AH9qbzwSY5YjAH1HkJjxp0EAUSjJIvyAIzqAKk2XDxdUWKxtHTRhHnDEQY1y2FYRskwvyWUj9MVxSVWdskKDUe41psxlo-215GWQmNF24vJ6yo44PKzhiWWlsym3eaqIyNHOjSuMtHPf9f6wvzh8MLJMU7EbUlwB7SgvM2gdXwb3YTooFrrqJWbSrqfPQYltCyFDeH4qhCqgfNw9coB-zqwXo3RBKwxDUljVbkApOI6shZxeKSZ8CmuTqhvRayLjmUgn4ww47Ro9omjq4IQJhwlSzHdWC11e8PQ2rDCOwucjED47Iv6hMYLXSWSaSQ9ToNhgVGuB_mEGm7dDMPkDBrGsb7aPuaqKI6i23xf4bUhSXpaLZqO6sxqZI7FwrsVyompWrVb7gG25_vJyTKKIx7fYWcw6mInyJdo1b8GNVpCqqvhM2A3gpHPOIZ2xXJK2L7dYFACqs1vrHnr8iDVsLNnAhSJfsC_1esYeQQUWR2-9BwOA3zJEC1ZzBN6LflOqR31Uh6zMBGOcqI1ClMXh5YUewJ_M1d_-GAg5ftAP0FGn1AI1aU-YLayFMdMLAvXtEYaMq7TMB4Qic_CNAS77_Ew5ZmF-1bObLC396MblczM43nYJPxYDQ3pnoyNFzOlDb9XTXHLefBvtF0tWcbmV3itHVeDHbrC789Xy9mS3G3cpUUjBS2SujinUOERUgHyZhFRXxhJQ1SOXImIHtmMRGu8omRuSV3gxQaPMnCnaXtvbG7kx_AnFnetBS0_hyOt9crOZj393TpQW2ASHYt7XUbPie_npXqtU3rsKaA4fwSH0d1fraYaYO6ny_daNqd9Da-dl8Md_M_M1qfL4eTybzi_PurxVMe_PgrVfnrTlVrMHAgnfVMSbjkHJ3L4cqtmZlNdA36K-e9Zf7Roucq0xJ9FxNIVo4h675oZ73anY-O51P5uPVvIMOWwgbYMTcpiOHqbXZea-vMXynMDx1C0WvGJ6ibleHp9g71J5ZLk0N_ASqi8grk-IM_b7wjz9-_ll8srcyJ2A5UHywEkXK3-LYeYYNJ5oP07655ZU8TtY3qtSvSqty2DXd3u7Rvtk1gem2-j1Fe5rqK6pd6baAnWfY27OaxV_PpFYx1t52Oc9UFrUtu05GdWUUzOy_UufZlCUWLqqSp16tNKay9ywo8t7jacyFoCvBP-4U1YR2l3464UCdDW6tViI1WZw4qqwFqgRm4Chz8zagouKpu1LWp6YeUXVMuPK8kbeDLNo7yWXBRh6gAvgyvHoKkeBL71gMFqdsgcrf8CufgSelyb-FiC2bFMXunXdyTaMM3ooU3db8ALicwpKQyYkoktw7OXqmlvBOPnkfvJPHLx4_PDp6cXx89Mvxi8cvnzwfeR-9k-Pjh788e3787OWTZ0cvnxw_e_555N2qbz5--PjoxYunL58_ffr8JUx58vm_afjOsA)
# üè¶ MiBanco API

**API REST para servicios bancarios** - Sistema completo de gesti√≥n bancaria desarrollado en .NET 8

[![.NET](https://img.shields.io/badge/.NET-8.0-blue.svg)](https://dotnet.microsoft.com/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)
[![Status](https://img.shields.io/badge/Status-Active-brightgreen.svg)]()

---

## üìã Tabla de Contenidos

- [üöÄ Inicio R√°pido](#-inicio-r√°pido)
- [üìñ Descripci√≥n](#-descripci√≥n)
- [üèóÔ∏è Arquitectura](#Ô∏è-arquitectura)
- [üîß Instalaci√≥n](#-instalaci√≥n)
- [üìö Documentaci√≥n de Endpoints](#-documentaci√≥n-de-endpoints)
- [üß™ Ejemplos de Uso](#-ejemplos-de-uso)
- [‚öôÔ∏è Configuraci√≥n](#Ô∏è-configuraci√≥n)
- [üîí Seguridad](#-seguridad)
- [üìä Monitoreo](#-monitoreo)
- [ü§ù Contribuci√≥n](#-contribuci√≥n)

---

## üöÄ Inicio R√°pido

### Prerrequisitos
- .NET 8.0 SDK
- Visual Studio 2022 o VS Code
- Postman (opcional, para pruebas)

### Ejecutar la API
\`\`\`bash
git clone <tu-repositorio>
cd MiBancoAPI
dotnet restore
dotnet run
\`\`\`

### Acceder a la Documentaci√≥n
- **Swagger UI**: `https://localhost:7xxx/index.html`
- **Health Check**: `https://localhost:7xxx/health`
- **API Info**: `https://localhost:7xxx/api/info`

---

## üìñ Descripci√≥n

MiBanco API es un sistema bancario completo que proporciona servicios para:

- ‚úÖ **Gesti√≥n de Clientes**: Registro, consulta y administraci√≥n
- ‚úÖ **Procesamiento de Pagos**: Dep√≥sitos, retiros y transferencias
- ‚úÖ **Sistema de Auditor√≠a**: Logging completo de operaciones
- ‚úÖ **Monitoreo**: Health checks y m√©tricas
- ‚úÖ **Documentaci√≥n**: Swagger UI integrado

### Caracter√≠sticas Principales

| Caracter√≠stica | Descripci√≥n |
|----------------|-------------|
| üèóÔ∏è **Arquitectura Limpia** | Separaci√≥n de responsabilidades |
| üîí **Seguridad** | Rate limiting, CORS, validaciones |
| üìä **Logging** | Serilog con archivos rotativos |
| üß™ **Validaciones** | FluentValidation integrado |
| üìö **Documentaci√≥n** | Swagger con ejemplos |
| üè• **Health Checks** | Monitoreo de servicios |

---

## üèóÔ∏è Arquitectura

\`\`\`
MiBancoAPI/
‚îú‚îÄ‚îÄ Controllers/          # Controladores de API
‚îú‚îÄ‚îÄ Models/              # Modelos de datos
‚îÇ   ‚îú‚îÄ‚îÄ Entities/        # Entidades del dominio
‚îÇ   ‚îî‚îÄ‚îÄ DTOs/           # Objetos de transferencia
‚îú‚îÄ‚îÄ Services/           # L√≥gica de negocio
‚îú‚îÄ‚îÄ Middleware/         # Middleware personalizado
‚îú‚îÄ‚îÄ Extensions/         # M√©todos de extensi√≥n
‚îú‚îÄ‚îÄ Validators/         # Validadores FluentValidation
‚îî‚îÄ‚îÄ Filters/           # Filtros de acci√≥n
\`\`\`

### Patrones Implementados
- **Repository Pattern** (simulado en memoria)
- **Dependency Injection**
- **Middleware Pipeline**
- **DTO Pattern**
- **Response Wrapper Pattern**

---

## üîß Instalaci√≥n

### 1. Clonar el Repositorio
\`\`\`bash
git clone <tu-repositorio>
cd MiBancoAPI
\`\`\`

### 2. Restaurar Dependencias
\`\`\`bash
dotnet restore
\`\`\`

### 3. Configurar Appsettings
\`\`\`json
{
  "MiBancoSettings": {
    "MaxTransactionAmount": 100000,
    "MinimumAge": 18,
    "MaxDailyTransactions": 10
  }
}
\`\`\`

### 4. Ejecutar la Aplicaci√≥n
\`\`\`bash
dotnet run
\`\`\`

---

## üìö Documentaci√≥n de Endpoints

### üè† **Sistema**

#### GET `/api/info`
Obtiene informaci√≥n general de la API.

**Respuesta:**
\`\`\`json
{
  "name": "MiBanco API",
  "version": "1.0.0",
  "environment": "Development",
  "timestamp": "2024-01-07T10:30:00Z",
  "status": "Running"
}
\`\`\`

#### GET `/health`
Verifica el estado de la API y servicios externos.

**Respuesta:**
\`\`\`json
{
  "status": "Healthy",
  "totalDuration": "00:00:00.0123456",
  "entries": {
    "database": {
      "status": "Healthy",
      "description": "Base de datos funcionando correctamente"
    }
  }
}
\`\`\`

---

### üë• **Clientes**

#### GET `/api/cliente`
Obtiene todos los clientes activos.

**Respuesta:**
\`\`\`json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "dpi": "1234567890101",
      "nombreCompleto": "Juan Carlos Garc√≠a L√≥pez",
      "email": "juan.garcia@email.com",
      "telefono": "12345678",
      "edad": 38,
      "saldoFormateado": "Q5,000.00",
      "estado": 1,
      "fechaCreacion": "2024-01-07T10:00:00Z"
    }
  ],
  "message": "Se encontraron 2 clientes"
}
\`\`\`

#### GET `/api/cliente/{dpi}`
Obtiene un cliente espec√≠fico por su DPI.

**Par√°metros:**
- `dpi` (string): N√∫mero de DPI de 13 d√≠gitos

**Ejemplo:** `GET /api/cliente/1234567890101`

**Respuesta:**
\`\`\`json
{
  "success": true,
  "data": {
    "id": 1,
    "dpi": "1234567890101",
    "nombres": "Juan Carlos",
    "apellidos": "Garc√≠a L√≥pez",
    "email": "juan.garcia@email.com",
    "telefono": "12345678",
    "fechaNacimiento": "1985-05-15T00:00:00Z",
    "direccion": "Zona 10, Ciudad de Guatemala",
    "saldoCuenta": 5000.00,
    "estado": 1,
    "nombreCompleto": "Juan Carlos Garc√≠a L√≥pez",
    "edad": 38,
    "saldoFormateado": "Q5,000.00"
  },
  "message": "Cliente encontrado exitosamente"
}
\`\`\`

#### POST `/api/cliente`
Crea un nuevo cliente.

**Body:**
\`\`\`json
{
  "dpi": "5555555555555",
  "nombres": "Ana Mar√≠a",
  "apellidos": "Gonz√°lez P√©rez",
  "email": "ana.gonzalez@email.com",
  "telefono": "55555555",
  "fechaNacimiento": "1992-03-15T00:00:00",
  "direccion": "Zona 15, Ciudad de Guatemala",
  "saldoInicial": 2500.00
}
\`\`\`

**Validaciones:**
- DPI: 13 d√≠gitos, √∫nico
- Nombres/Apellidos: 2-100 caracteres, solo letras
- Email: formato v√°lido
- Tel√©fono: 8 d√≠gitos
- Edad: mayor de 18 a√±os
- Saldo inicial: 0 - 1,000,000

---

### üí∞ **Pagos**

#### GET `/api/pago`
Obtiene todos los pagos registrados.

**Respuesta:**
\`\`\`json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "dpiCliente": "1234567890101",
      "monto": 500.00,
      "montoFormateado": "Q500.00",
      "concepto": "Pago de servicios b√°sicos",
      "tipoPago": 1,
      "numeroReferencia": "REF001",
      "fechaPago": "2024-01-02T10:00:00Z",
      "estado": 3
    }
  ],
  "message": "Se encontraron 2 pagos"
}
\`\`\`

#### GET `/api/pago/cliente/{dpi}`
Obtiene el historial de pagos de un cliente.

**Ejemplo:** `GET /api/pago/cliente/1234567890101`

#### POST `/api/pago`
Crea un nuevo pago.

**Body:**
\`\`\`json
{
  "dpiCliente": "1234567890101",
  "monto": 1000.00,
  "concepto": "Dep√≥sito en efectivo",
  "tipoPago": 2,
  "numeroReferencia": "DEP001",
  "notasAdicionales": "Dep√≥sito realizado en sucursal"
}
\`\`\`

**Tipos de Pago:**
- `1`: Transferencia
- `2`: Dep√≥sito
- `3`: Retiro
- `4`: Pago de Servicios
- `5`: Pago de Pr√©stamo

**Estados de Pago:**
- `1`: Pendiente
- `2`: Procesando
- `3`: Completado
- `4`: Fallido
- `5`: Cancelado

---

### üìã **Logs**

#### GET `/api/log`
Obtiene todos los logs del sistema.

#### GET `/api/log/fecha/{fecha}`
Obtiene logs de una fecha espec√≠fica.

**Ejemplo:** `GET /api/log/fecha/2024-01-07`

#### GET `/api/log/nivel/{nivel}`
Obtiene logs por nivel de severidad.

**Niveles:**
- `1`: Info
- `2`: Warning
- `3`: Error
- `4`: Debug

---

## üß™ Ejemplos de Uso

### Flujo Completo de Operaciones

#### 1. Crear un Cliente
\`\`\`bash
curl -X POST "https://localhost:7xxx/api/cliente" \
  -H "Content-Type: application/json" \
  -d '{
    "dpi": "9999999999999",
    "nombres": "Carlos",
    "apellidos": "Mendoza",
    "email": "carlos@email.com",
    "telefono": "99999999",
    "fechaNacimiento": "1990-01-01T00:00:00",
    "direccion": "Zona 1, Guatemala",
    "saldoInicial": 1000.00
  }'
\`\`\`

#### 2. Realizar un Dep√≥sito
\`\`\`bash
curl -X POST "https://localhost:7xxx/api/pago" \
  -H "Content-Type: application/json" \
  -d '{
    "dpiCliente": "9999999999999",
    "monto": 500.00,
    "concepto": "Dep√≥sito inicial",
    "tipoPago": 2
  }'
\`\`\`

#### 3. Consultar Saldo
\`\`\`bash
curl -X GET "https://localhost:7xxx/api/cliente/9999999999999"
\`\`\`

#### 4. Ver Historial
\`\`\`bash
curl -X GET "https://localhost:7xxx/api/pago/cliente/9999999999999"
\`\`\`

---

## ‚öôÔ∏è Configuraci√≥n

### Variables de Entorno

| Variable | Descripci√≥n | Valor por Defecto |
|----------|-------------|-------------------|
| `ASPNETCORE_ENVIRONMENT` | Entorno de ejecuci√≥n | Development |
| `ASPNETCORE_URLS` | URLs de escucha | https://localhost:7xxx |

### Configuraci√≥n de Aplicaci√≥n

\`\`\`json
{
  "MiBancoSettings": {
    "MaxTransactionAmount": 100000,
    "MinimumAge": 18,
    "MaxDailyTransactions": 10,
    "EnableNotifications": true
  },
  "ExternalServices": {
    "BankingServiceUrl": "https://api.external-bank.com",
    "Timeout": "00:00:30"
  }
}
\`\`\`

### Rate Limiting

- **L√≠mite**: 100 requests por minuto
- **Cola**: 10 requests en espera
- **Pol√≠tica**: Ventana fija

---

## üîí Seguridad

### Medidas Implementadas

- ‚úÖ **HTTPS Obligatorio**
- ‚úÖ **CORS Configurado**
- ‚úÖ **Rate Limiting**
- ‚úÖ **Validaci√≥n de Entrada**
- ‚úÖ **Manejo de Excepciones**
- ‚úÖ **Logging de Seguridad**

### Validaciones de Negocio

- **DPI**: √önico, 13 d√≠gitos
- **Edad**: M√≠nimo 18 a√±os
- **Montos**: L√≠mites configurables
- **Saldos**: No negativos
- **Retiros**: Verificaci√≥n de fondos

---

## üìä Monitoreo

### Health Checks

La API incluye verificaciones de salud en `/health`:

- **Database**: Simulaci√≥n de conexi√≥n a BD
- **External Services**: Verificaci√≥n de servicios externos
- **Memory**: Uso de memoria
- **Disk**: Espacio disponible

### Logging

Configurado con **Serilog**:

- **Console**: Desarrollo
- **File**: Archivos rotativos diarios
- **Structured**: Formato JSON
- **Levels**: Info, Warning, Error, Debug

### M√©tricas

- Tiempo de respuesta por endpoint
- N√∫mero de requests por minuto
- Errores por tipo
- Uso de recursos

---

## üöÄ Despliegue

### Desarrollo Local
\`\`\`bash
dotnet run --environment Development
\`\`\`

### Producci√≥n
\`\`\`bash
dotnet publish -c Release
dotnet MiBancoAPI.dll --environment Production
\`\`\`

### Docker (Futuro)
\`\`\`dockerfile
FROM mcr.microsoft.com/dotnet/aspnet:8.0
COPY . /app
WORKDIR /app
EXPOSE 80
ENTRYPOINT ["dotnet", "MiBancoAPI.dll"]
\`\`\`

---

## üß™ Testing

### Postman Collection

Importa la colecci√≥n de Postman incluida para probar todos los endpoints:

1. Abrir Postman
2. Import ‚Üí File ‚Üí Seleccionar `MiBanco-API.postman_collection.json`
3. Configurar variable `baseUrl` con tu puerto local

### Casos de Prueba

- ‚úÖ Crear cliente v√°lido
- ‚úÖ Validaciones de DPI
- ‚úÖ Dep√≥sitos y retiros
- ‚úÖ Saldos insuficientes
- ‚úÖ Clientes inexistentes
- ‚úÖ Rate limiting
- ‚úÖ Health checks

---
### FAQ

**Q: ¬øC√≥mo cambio el puerto?**
A: Modifica `launchSettings.json` o usa `--urls` parameter.

**Q: ¬øD√≥nde est√°n los logs?**
A: En la carpeta `logs/` con rotaci√≥n diaria.

**Q: ¬øC√≥mo agrego m√°s validaciones?**
A: Extiende los validators en `Validators/`.

---


## Herramientas:

- **Microsoft** por .NET 8
- **Swashbuckle** por Swagger integration
- **Serilog** por logging
- **FluentValidation** por validaciones

---

**¬°Gracias por ver mi  API!** üè¶‚ú®

